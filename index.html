<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ™ºæ¢°GPTå®¢æœå°å¹«æ‰‹</title>
  <base href="https://lunirain.github.io/SynMindgpt-assistant-ai-bot/">

  <style>
    /* ===== å…¨åŸŸ ===== */
    body{
      font-family:sans-serif;
      padding:2rem;
      background:#fff6f6;
    }
    input,button{
      font-size:1rem;
      padding:0.5rem;
    }
    #displayInfo{
      margin-top:1rem;
      color:gray;
    }

   /* ===== å›è¦†å¡ç‰‡æ¨£å¼ ===== */
.container-gpt{
  background:#ffecec;
  border-left:5px solid #ff6b6b;
  border-radius:6px;
  padding:0.2rem 1rem 0.6rem 1rem;  /* ä¸Šå³ä¸‹å·¦ */
  margin:0;
  white-space:pre-wrap;
}
.container-gpt *{ margin:0 }        /* æŠŠ p / ul / ol é è¨­å¤–è·æ­¸é›¶ */

.reply-header{
  font-size:1.5rem;
  font-weight:bold;
  padding:0.4rem 0 0.4rem 0;        /* ä¸Šä¸‹å„ 0.4rem */
  line-height:1.2;
}
.reply-content{ line-height:1.6; }  /* å…§æ–‡è¡Œè· */
    
   /* ===== è¤‡è£½æŒ‰éˆ• ===== */
.copy-button{
  display:inline-flex;              /* å°å°ºå¯¸å·¦é  */
  align-items:center;               /* å‚ç›´ç½®ä¸­æ–‡å­—èˆ‡ emoji */
  justify-content:center;           /* æ°´å¹³ç½®ä¸­ */
  margin-top:1rem;
  font-size:1rem;
  line-height:1;                    /* é˜² emoji æ¨é«˜ */
  padding:0.5rem 1rem;
  border:1px solid #ccc;
  border-radius:6px;
  background:#f9f9f9;
  cursor:pointer;
}
  </style>
</head>

<body>
  <h2>
    <img src="images/logo.png" alt="logo"
         style="width:70px;vertical-align:middle;margin-right:0.5rem;">
    æ™ºæ¢°GPTå®¢æœå°å¹«æ‰‹
  </h2>

  <input id="uid" placeholder="è«‹è¼¸å…¥æ‚¨çš„å•é¡Œ" style="width:70%;" type="text"/>
  <button id="addBtn">è©¢å•</button>

  <div id="displayInfo">ğŸ‘‰ æº–å‚™å°±ç·’</div>
  <div id="displayGPTHere"></div>

<script>
/*================ å…±ç”¨è®Šæ•¸ ================*/
const userId = localStorage.getItem("gpt_user") || (() => {
  const id = "user-" + Date.now();
  localStorage.setItem("gpt_user", id);
  return id;
})();
document.getElementById("addBtn").addEventListener("click", sendMessage);
document.getElementById("uid").addEventListener("keydown", e=>{
  if(e.key==="Enter") sendMessage();
});

/*================ ä¸»æµç¨‹ ================*/
function sendMessage() {
  const message = document.getElementById("uid").value.trim();
  if (!message) return alert("è«‹è¼¸å…¥æ‚¨çš„å•é¡Œ");

  /* UI: loading */
  const btn = document.getElementById("addBtn");
  btn.disabled = true;
  btn.innerText = "æŸ¥è©¢ä¸­â€¦";
  document.getElementById("displayInfo").innerText = "ğŸ¤– æ©Ÿå™¨äººæ€è€ƒä¸­â€¦";
  document.getElementById("displayGPTHere").innerHTML = "";

  /* å‘¼å«å¾Œç«¯ API */
  fetch("https://syn-mindgpt-assistant-ai-bot.vercel.app/api/ask", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ userId, message })
  })
    .then(res => {
      if (!res.ok) throw new Error("ä¼ºæœå™¨éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦");
      return res.json();
    })
    .then(data => {
      const reply = data.reply || "âš ï¸ æ²’æœ‰æ”¶åˆ°å›è¦†";
      /* å°‡ reply å¡é€² data-textï¼Œçµ¦æŒ‰éˆ•çµ±ä¸€è¤‡è£½ç”¨ */
      document.getElementById("displayGPTHere").innerHTML = `
      <div class="container-gpt">
        <div class="reply-header">ğŸ¤– å°å¹«æ‰‹ï¼š</div>
        <div class="reply-content">${reply}</div>
        <button class="copy-button" data-text="${reply}">ğŸ“‹ è¤‡è£½å›è¦†</button>
      </div>`; // â† ç·Šè²¼çµå°¾
      document.getElementById("displayInfo").innerText = "âœ… å›è¦†å®Œæˆ";
      document.getElementById("uid").value = ""; // æ¸…ç©ºè¼¸å…¥
    })
    .catch(err => {
      document.getElementById("displayInfo").innerText = "âŒ éŒ¯èª¤ï¼š" + err.message;
    })
    .finally(() => {
      btn.disabled = false;
      btn.innerText = "è©¢å•";
    });
}

/*================ è¤‡è£½åŠŸèƒ½ ================*/
/* ç›£è½æ•´é é»æ“Šï¼›å¦‚æœé»åˆ° .copy-button å°±è¤‡è£½å…¶ data-text å…§å®¹ */
document.addEventListener("click", e => {
  if (e.target.classList.contains("copy-button")) {
    const text = e.target.dataset.text || "";
    copyText(text);
  }
});

function copyText(text) {
  navigator.clipboard.writeText(text)
    .then(() => alert("âœ… å·²è¤‡è£½å›è¦†å…§å®¹ï¼"))
    .catch(() => alert("âŒ è¤‡è£½å¤±æ•—ï¼Œå¯èƒ½æ˜¯ç€è¦½å™¨æ¬Šé™é˜»æ“‹"));
}
</script>
</body>
</html>
